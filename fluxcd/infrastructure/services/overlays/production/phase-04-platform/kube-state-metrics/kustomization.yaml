apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: gossip-stone
resources:
  - ../../../../base/kube-state-metrics
patches:
  - target:
      kind: ClusterRoleBinding
      name: kube-state-metrics
    patch: |-
      - op: replace
        path: /subjects/0/namespace
        value: gossip-stone
  - target:
      kind: Deployment
      name: kube-state-metrics
    patch: |-
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: kube-state-metrics
      spec:
        template:
          metadata:
            labels:
              policy.prplanit.com/metrics: "true"
