apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: weave-gitops
spec:
  targetNamespace: gossip-stone
  valuesFrom:
    - kind: ConfigMap
      name: weave-gitops-values
      valuesKey: values.yaml
  values:
    podLabels:
      policy.prplanit.com/ingress: "true"
      policy.prplanit.com/metrics: "true"
    service:
      type: ClusterIP
    resources:
      requests:
        cpu: 100m
        memory: 64Mi
      limits:
        cpu: 1
        memory: 512Mi
    securityContext:
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: true
      runAsNonRoot: true
      runAsUser: 1000
