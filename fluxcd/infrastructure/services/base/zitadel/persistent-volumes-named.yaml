# Named RBD PersistentVolumes for Zitadel Postgres cluster
# These replace auto-generated CSI volumes with predictable names for easier tracking
# Naming pattern: <namespace>-<cluster-name>-<instance-number>
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: zeldas-lullaby-zitadel-postgres-1
spec:
  capacity:
    storage: PLACEHOLDER_STORAGE_SIZE
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  storageClassName: PLACEHOLDER_STORAGE_CLASS
  mountOptions:
    - discard
  csi:
    driver: rbd.csi.ceph.com
    fsType: ext4
    volumeHandle: zeldas-lullaby-zitadel-postgres-1
    volumeAttributes:
      clusterID: PLACEHOLDER_CLUSTER_ID
      pool: PLACEHOLDER_POOL
      staticVolume: "true"
      imageName: zeldas-lullaby-zitadel-postgres-1
    nodeStageSecretRef:
      name: PLACEHOLDER_SECRET_NAME
      namespace: PLACEHOLDER_SECRET_NAMESPACE
    controllerExpandSecretRef:
      name: PLACEHOLDER_SECRET_NAME
      namespace: PLACEHOLDER_SECRET_NAMESPACE
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: zeldas-lullaby-zitadel-postgres-2
spec:
  capacity:
    storage: PLACEHOLDER_STORAGE_SIZE
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  storageClassName: PLACEHOLDER_STORAGE_CLASS
  mountOptions:
    - discard
  csi:
    driver: rbd.csi.ceph.com
    fsType: ext4
    volumeHandle: zeldas-lullaby-zitadel-postgres-2
    volumeAttributes:
      clusterID: PLACEHOLDER_CLUSTER_ID
      pool: PLACEHOLDER_POOL
      staticVolume: "true"
      imageName: zeldas-lullaby-zitadel-postgres-2
    nodeStageSecretRef:
      name: PLACEHOLDER_SECRET_NAME
      namespace: PLACEHOLDER_SECRET_NAMESPACE
    controllerExpandSecretRef:
      name: PLACEHOLDER_SECRET_NAME
      namespace: PLACEHOLDER_SECRET_NAMESPACE
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: zeldas-lullaby-zitadel-postgres-3
spec:
  capacity:
    storage: PLACEHOLDER_STORAGE_SIZE
  volumeMode: Filesystem
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  storageClassName: PLACEHOLDER_STORAGE_CLASS
  mountOptions:
    - discard
  csi:
    driver: rbd.csi.ceph.com
    fsType: ext4
    volumeHandle: zeldas-lullaby-zitadel-postgres-3
    volumeAttributes:
      clusterID: PLACEHOLDER_CLUSTER_ID
      pool: PLACEHOLDER_POOL
      staticVolume: "true"
      imageName: zeldas-lullaby-zitadel-postgres-3
    nodeStageSecretRef:
      name: PLACEHOLDER_SECRET_NAME
      namespace: PLACEHOLDER_SECRET_NAMESPACE
    controllerExpandSecretRef:
      name: PLACEHOLDER_SECRET_NAME
      namespace: PLACEHOLDER_SECRET_NAMESPACE
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: zitadel-postgres-1
  labels:
    cnpg.io/cluster: zitadel-postgres
    cnpg.io/instanceName: zitadel-postgres-1
    cnpg.io/pvcRole: PG_DATA
spec:
  accessModes:
    - ReadWriteOnce
  volumeMode: Filesystem
  resources:
    requests:
      storage: PLACEHOLDER_STORAGE_SIZE
  storageClassName: PLACEHOLDER_STORAGE_CLASS
  volumeName: zeldas-lullaby-zitadel-postgres-1
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: zitadel-postgres-2
  labels:
    cnpg.io/cluster: zitadel-postgres
    cnpg.io/instanceName: zitadel-postgres-2
    cnpg.io/pvcRole: PG_DATA
spec:
  accessModes:
    - ReadWriteOnce
  volumeMode: Filesystem
  resources:
    requests:
      storage: PLACEHOLDER_STORAGE_SIZE
  storageClassName: PLACEHOLDER_STORAGE_CLASS
  volumeName: zeldas-lullaby-zitadel-postgres-2
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: zitadel-postgres-3
  labels:
    cnpg.io/cluster: zitadel-postgres
    cnpg.io/instanceName: zitadel-postgres-3
    cnpg.io/pvcRole: PG_DATA
spec:
  accessModes:
    - ReadWriteOnce
  volumeMode: Filesystem
  resources:
    requests:
      storage: PLACEHOLDER_STORAGE_SIZE
  storageClassName: PLACEHOLDER_STORAGE_CLASS
  volumeName: zeldas-lullaby-zitadel-postgres-3
