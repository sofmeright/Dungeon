apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - ../../../base/cert-manager
  - gateway-certificates.yaml
patches:
  - path: clusterissuer-patch.yaml
    target:
      kind: ClusterIssuer
  # Set namespace for ExternalSecrets to king-of-red-lions (where cert-manager runs)
  - patch: |-
      - op: add
        path: /metadata/namespace
        value: king-of-red-lions
    target:
      kind: ExternalSecret
  # Set namespace for gateway certificates to hyrule-castle
  - patch: |-
      - op: add
        path: /metadata/namespace
        value: hyrule-castle
    target:
      kind: Certificate
