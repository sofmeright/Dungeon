# Ceph authentication secrets - encrypt with SOPS after adding credentials
# These use dedicated users with minimal privileges (NOT admin)
#
# To create these users on your Proxmox Ceph cluster:
# 1. SSH to Proxmox node
# 2. Get cluster ID: ceph fsid
# 3. Create provisioner user: 
#    ceph auth get-or-create client.dungeon-provisioner \
#      mon 'allow r, allow command "osd blacklist"' \
#      osd 'allow rwx pool=kubernetes' \
#      mgr 'allow rw'
# 4. Create mount user:
#    ceph auth get-or-create client.dungeon \
#      mon 'allow r' \
#      osd 'allow class-read object_prefix rbd_children, allow rwx pool=kubernetes'
# 5. Get the keys: 
#    ceph auth get-key client.dungeon-provisioner
#    ceph auth get-key client.dungeon
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret
    namespace: prplanit-system
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:A2WFsUINZC0ElBr+c2WknsKE64+MJf5Oqf5jTFV6U5tEAvl25N6loo017Q==,iv:dbhKG/10bnsrNw50TGkRD0Zp0LyJlu2ygjGzmNHcnRA=,tag:mcxPQBC/sIInt29COhDXNg==,type:comment]
    userID: ENC[AES256_GCM,data:nmSmkzwMdY8jMIcmUr0MorLBDA==,iv:TmcK81oBWKcesJKwkDH2YleSA5bkZt1r+6KNrhAZ1e4=,tag:Slmc5bULiBuI49rJ87XIDg==,type:str]
    userKey: ENC[AES256_GCM,data:aVQ3fxexOsnQY6Q07MejI/NmYGX9PYBvk6FeppE1bb8OCKe6r83qvQ==,iv:wTMTeSZMp9RuGi732/KB95ZW73D5sRO8yVFOFkjMqjY=,tag:d1OjXiPYfffWnP6ly75pig==,type:str]
sops:
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB0ejNvczAxeEdGU2FKeGtF
            UDUvV01kMFdGK3JUOFVzNWlwRE9kTWNyQURnCllpOWwxTlNZY0UrTFF6WEhlano3
            ZUtHNUJkcEl2OUJDeGsxQU5nZ2EvcTQKLS0tIDYxNjBUdFhVSDNQa1lxSnFINTlm
            Vng3ZU5VY21SUlhNaGxUYVEyWVNUcTQK+LRBHo1SFDA7GVNb6uP+agu05S5k7vG9
            MRkQH/aTCizFXJylCne/fx8jRvNfmXC3s1zkO2lyYLG3BgfgghmYBA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-27T15:54:29Z"
    mac: ENC[AES256_GCM,data:lWJiCF52S7E0NmJHerwkmHo6kTgmCzowuBXpK92WyPfqH2K9IMoDgHojd6JAFCStwMZLcGHjhF2dYUcRN2J8ANvAznorQ5NmKjs+Ts/aIvWxbpgIE/MzzelU/Fjk5Yha15vCC5ZZ1qqyeqXiK/EozNP9WUvGiv3k5zFnT0o6stw=,iv:tjz7WMigJ/7BdgT3S1dEHY9yDVJtolDEjEaEHr7soMo=,tag:5vGY8/kMWTdrbDQcubsPjg==,type:str]
    encrypted_regex: ^(data|stringData)$
    version: 3.10.2
---
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret-user
    namespace: prplanit-system
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:Ssko8OdFLiFCsln3zusgtsYCtyyMeAzAj9fcn3jzWLJ+0tKVVt3K,iv:Pi1U8hMB0sS0PDoRbZcpP1h5Idbki99FBJG96SSGRG0=,tag:yATdHL+6hJ43RTUxWsPqrw==,type:comment]
    userID: ENC[AES256_GCM,data:AzvrNHsAwg==,iv:h0ukB8HeOecs1NhfdpNPUXccLKjN5ytAnO+TMk+TrH0=,tag:HEHPPZHKaWC0ADJW+OkFiQ==,type:str]
    userKey: ENC[AES256_GCM,data:IgyOYxkrap3mNdD9DSeAm3gr5ZoePKcM6iOAXE3GXN8R712+FUHwjg==,iv:2j6QKEaxpKXiRH556kdKoq1E06OsRln2qNJXPSM4Evk=,tag:tb/4p9VkNB2IT3EMQmt2VA==,type:str]
sops:
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSB0ejNvczAxeEdGU2FKeGtF
            UDUvV01kMFdGK3JUOFVzNWlwRE9kTWNyQURnCllpOWwxTlNZY0UrTFF6WEhlano3
            ZUtHNUJkcEl2OUJDeGsxQU5nZ2EvcTQKLS0tIDYxNjBUdFhVSDNQa1lxSnFINTlm
            Vng3ZU5VY21SUlhNaGxUYVEyWVNUcTQK+LRBHo1SFDA7GVNb6uP+agu05S5k7vG9
            MRkQH/aTCizFXJylCne/fx8jRvNfmXC3s1zkO2lyYLG3BgfgghmYBA==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-27T15:54:29Z"
    mac: ENC[AES256_GCM,data:lWJiCF52S7E0NmJHerwkmHo6kTgmCzowuBXpK92WyPfqH2K9IMoDgHojd6JAFCStwMZLcGHjhF2dYUcRN2J8ANvAznorQ5NmKjs+Ts/aIvWxbpgIE/MzzelU/Fjk5Yha15vCC5ZZ1qqyeqXiK/EozNP9WUvGiv3k5zFnT0o6stw=,iv:tjz7WMigJ/7BdgT3S1dEHY9yDVJtolDEjEaEHr7soMo=,tag:5vGY8/kMWTdrbDQcubsPjg==,type:str]
    encrypted_regex: ^(data|stringData)$
    version: 3.10.2
