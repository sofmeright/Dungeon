# Ceph authentication secrets - encrypt with SOPS after adding credentials
# These use dedicated users with minimal privileges (NOT admin)
#
# To create these users on your Proxmox Ceph cluster:
# 1. SSH to Proxmox node
# 2. Get cluster ID: ceph fsid
# 3. Create provisioner user: 
#    ceph auth get-or-create client.dungeon-provisioner \
#      mon 'allow r, allow command "osd blacklist"' \
#      osd 'allow rwx pool=kubernetes' \
#      mgr 'allow rw'
# 4. Create mount user:
#    ceph auth get-or-create client.dungeon \
#      mon 'allow r' \
#      osd 'allow class-read object_prefix rbd_children, allow rwx pool=kubernetes'
# 5. Get the keys: 
#    ceph auth get-key client.dungeon-provisioner
#    ceph auth get-key client.dungeon
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret
    namespace: kube-system
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:bSFHBwKXiR5pNqrqyqmFYsX+jiCQgLlVMjA8quRfSzrM4x8EoRE15lxKWg==,iv:wdgSfSDLMbZvdPOEPUf4mcLxPkbfuveyiUp3dHvexT8=,tag:zRRE2GDHC0o9dhyKVl3zEA==,type:comment]
    userID: ENC[AES256_GCM,data:J6x/B1oDEVsQaJGHUYI2sUq0yA==,iv:mixwp0Pn4FydthnoXxPzSgynmGWZUeRG8ICUM5EBY3w=,tag:jCaX8kccCTcmI9gnXsqvKQ==,type:str]
    userKey: ENC[AES256_GCM,data:0whNEGyFX+SvVZMxP2lH2dZBW/AVUHTtqjrTrNZTzvrEUPOT1+5c3Q==,iv:Wj18dQEOr/4pftlrrpSbFkCe4d7nZqy0DQtz+zUJbGw=,tag:LVOvax5tjG0jZ2jEi5o/zw==,type:str]
sops:
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBLSnJmTkNIWVdRZXYvRFo3
            a0lyNFhoYktiR241TmFzc1ArM1A5a215VTB3CjVSNXZsNUdyaVEybEh3SVdJL3d2
            UE5UREYwRHc2TlZhd01lN1liTUhtSkkKLS0tIFRTZm9JOHpKOG5jdGVxcTdLYlEx
            ZVlzU1RIWGFqeXFTS2IyRGFvZHlpUncKzzSR42HiXZvUeehPw0vP6qQyk+lbjIfH
            k4QDrgWPSJVFNex6yn99Dl6GB9OZjGGo8ZNghNl610b6bNaTVdjeGw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-28T23:55:20Z"
    mac: ENC[AES256_GCM,data:EOftteSFEhleS13+uosI+gdMsOOVoA9neo/qzJyI1MQEY2lsVKt1Zoy0Wb8nDwEvzXBXTxB8iVjFgLOHXRsdA5cs3Ev1Gj9xNyUDJtSUGv1L3saul0DKbiMQPL88p+pn3tYMZINUAmXHOYOk/ze2DDsNfnM0aQkI2gqBeyPEavY=,iv:WnCzS+PZI0VOWFJ3EjOSsJBvpLNLuxDF0LNm4z3f29Q=,tag:CA0HhrOpHe304XA4Ja6trA==,type:str]
    encrypted_regex: ^(data|stringData)$
    version: 3.10.2
---
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret-user
    namespace: kube-system
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:GhfVrt7QTQtQykR7w47jZVkz9N2Oh+d5kVSaDqApeTmjJj02EdM4,iv:92m78iAOjJTRXn15F5EGAQcwVC0QMiIxmnNXFaOFtvw=,tag:CS0KFX+JCbHmRngkRkFLlQ==,type:comment]
    userID: ENC[AES256_GCM,data:D60k4JJTkw==,iv:saq8Zz/RDXgieAjznimYkk7/p5xZqXNYCwOf2D07Opg=,tag:mnPUyumqPvpNwsOxLCulXw==,type:str]
    userKey: ENC[AES256_GCM,data:eAUz5lgMnH4EK3Yy/BnHsA6idTShpG/gB/RuKRmKQNmgio+RHa/yYQ==,iv:SkPNLyqpJGTxS1OCCURNd7Ow42sNaiwxIfhD5vyBrCc=,tag:oshWhQfsCl9lu7nVO46s7Q==,type:str]
sops:
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBLSnJmTkNIWVdRZXYvRFo3
            a0lyNFhoYktiR241TmFzc1ArM1A5a215VTB3CjVSNXZsNUdyaVEybEh3SVdJL3d2
            UE5UREYwRHc2TlZhd01lN1liTUhtSkkKLS0tIFRTZm9JOHpKOG5jdGVxcTdLYlEx
            ZVlzU1RIWGFqeXFTS2IyRGFvZHlpUncKzzSR42HiXZvUeehPw0vP6qQyk+lbjIfH
            k4QDrgWPSJVFNex6yn99Dl6GB9OZjGGo8ZNghNl610b6bNaTVdjeGw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-28T23:55:20Z"
    mac: ENC[AES256_GCM,data:EOftteSFEhleS13+uosI+gdMsOOVoA9neo/qzJyI1MQEY2lsVKt1Zoy0Wb8nDwEvzXBXTxB8iVjFgLOHXRsdA5cs3Ev1Gj9xNyUDJtSUGv1L3saul0DKbiMQPL88p+pn3tYMZINUAmXHOYOk/ze2DDsNfnM0aQkI2gqBeyPEavY=,iv:WnCzS+PZI0VOWFJ3EjOSsJBvpLNLuxDF0LNm4z3f29Q=,tag:CA0HhrOpHe304XA4Ja6trA==,type:str]
    encrypted_regex: ^(data|stringData)$
    version: 3.10.2
