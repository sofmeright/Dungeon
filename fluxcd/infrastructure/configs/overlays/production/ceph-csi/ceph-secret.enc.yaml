# Ceph authentication secrets - encrypt with SOPS after adding credentials
# These use dedicated users with minimal privileges (NOT admin)
#
# To create these users on your Proxmox Ceph cluster:
# 1. SSH to Proxmox node
# 2. Get cluster ID: ceph fsid
# 3. Create provisioner user: 
#    ceph auth get-or-create client.dungeon-provisioner \
#      mon 'allow r, allow command "osd blacklist"' \
#      osd 'allow rwx pool=kubernetes' \
#      mgr 'allow rw'
# 4. Create mount user:
#    ceph auth get-or-create client.dungeon \
#      mon 'allow r' \
#      osd 'allow class-read object_prefix rbd_children, allow rwx pool=kubernetes'
# 5. Get the keys: 
#    ceph auth get-key client.dungeon-provisioner
#    ceph auth get-key client.dungeon
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret
    namespace: ceph-csi
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:Snfii/tEbzda+rjpuYb3X8zcNRBuvfhfVDunU347444v7H7JwniHFdJOVQ==,iv:swKYM2iwO8bUahZ+/tDiujvXZMtMCrQMR1xD07dse1k=,tag:4L9bRvVlDjf8lrgiecPzFQ==,type:comment]
    userID: ENC[AES256_GCM,data:4R6K7Ta59i+KudaitYRV1bUPUA==,iv:N/+nKxCXLRXproZL9P1P4KVIx8h7lNiL5s0MmFAMpS0=,tag:x+OaM2LqZJCI23pV7gJlWA==,type:str]
    userKey: ENC[AES256_GCM,data:pXDIaOTOSsxmbedHEp6wP3IA942UTd8iABWKmwc2mXQX21FnB+8tlw==,iv:UWmpE9z8WpdmsiSfCdxVhulM401Dqs6vUUgklUlkT7M=,tag:pGG9f2y7qHyc4yyIAh5D9g==,type:str]
sops:
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBlU0pTNU1xT085U1Iwd3NJ
            cHRBQnc4Znlob2RDcWhobzk5aDRROHRxNUEwCk93RVBCR0NmMmdiKy83Qmtld2w3
            bVZ5OWkyUDE2ZXVqRGFsTFJ1VzV5cWsKLS0tIGx2NlU3dmZnajBkdzN2QTJsN0U1
            cUdsbUpIa0RCL3ZaaDRJeWFjQm5aSm8KP7NmG4fhn/E1bFKLKYyMFwXZUuliARfu
            4yE5l65KrN8XVgQTMpDBNeIJrZeY/MNlwt1o9JaQdEpwlC6+w55y+A==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-27T16:52:32Z"
    mac: ENC[AES256_GCM,data:QUcuJYdT75ejTRcmjCROczhhiVLWqU5ztRPN76NVvyKrF8RcjWSii5iWJKnGqynDheFlaq5Mb/vPWAj81MtaDFeFmSc/TMWxomQu2OuDkMnZklBijuJkyw9TpgCh3lAElEOFteGS0Bdd/2u1BB/NPgn1jI08zArPbye8dotv9so=,iv:BuWWubtr0U8BJd1UkLAES5AHq49ZZ8Py8DRjP5kV4Yw=,tag:p+QMkQQ8YcDfc9KXrqqnaw==,type:str]
    encrypted_regex: ^(data|stringData)$
    version: 3.10.2
---
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret-user
    namespace: ceph-csi
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:AoYl3jUdLAIqzkG5lDDa3uKHW7bJBv3co44Gqtl07MzGfo8Gv8fc,iv:gXO4m7XXzwPpOgNHNSPnr3e/M3Wwu0knIzP78NXymiA=,tag:DpMeJeNEr66YlGv7XnKq8g==,type:comment]
    userID: ENC[AES256_GCM,data:Yrdmfu/enA==,iv:VTG1tDPKWreQ8GEr/qFfyPi2fOYgXulU66V0cpbqOSU=,tag:JDCJy88fzw48dQfN9PL4iw==,type:str]
    userKey: ENC[AES256_GCM,data:Gamgm9j3V1MY8FZojxfD2Oc2Pv14zOf9QsDOcVJDMsoX3FDhRh2SCg==,iv:+mi4AkvC9DagIufkJ7bzBZL+KRBsctkwnxy3GmOiveU=,tag:e4Sucj7GcJ1J+qClAyH/Dw==,type:str]
sops:
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBlU0pTNU1xT085U1Iwd3NJ
            cHRBQnc4Znlob2RDcWhobzk5aDRROHRxNUEwCk93RVBCR0NmMmdiKy83Qmtld2w3
            bVZ5OWkyUDE2ZXVqRGFsTFJ1VzV5cWsKLS0tIGx2NlU3dmZnajBkdzN2QTJsN0U1
            cUdsbUpIa0RCL3ZaaDRJeWFjQm5aSm8KP7NmG4fhn/E1bFKLKYyMFwXZUuliARfu
            4yE5l65KrN8XVgQTMpDBNeIJrZeY/MNlwt1o9JaQdEpwlC6+w55y+A==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-27T16:52:32Z"
    mac: ENC[AES256_GCM,data:QUcuJYdT75ejTRcmjCROczhhiVLWqU5ztRPN76NVvyKrF8RcjWSii5iWJKnGqynDheFlaq5Mb/vPWAj81MtaDFeFmSc/TMWxomQu2OuDkMnZklBijuJkyw9TpgCh3lAElEOFteGS0Bdd/2u1BB/NPgn1jI08zArPbye8dotv9so=,iv:BuWWubtr0U8BJd1UkLAES5AHq49ZZ8Py8DRjP5kV4Yw=,tag:p+QMkQQ8YcDfc9KXrqqnaw==,type:str]
    encrypted_regex: ^(data|stringData)$
    version: 3.10.2
