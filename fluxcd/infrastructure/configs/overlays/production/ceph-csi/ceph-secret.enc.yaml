# Ceph authentication secrets - encrypt with SOPS after adding credentials
# These use dedicated users with minimal privileges (NOT admin)
#
# To create these users on your Proxmox Ceph cluster:
# 1. SSH to Proxmox node
# 2. Get cluster ID: ceph fsid
# 3. Create provisioner user: 
#    ceph auth get-or-create client.dungeon-provisioner \
#      mon 'allow r, allow command "osd blacklist"' \
#      osd 'allow rwx pool=kubernetes' \
#      mgr 'allow rw'
# 4. Create mount user:
#    ceph auth get-or-create client.dungeon \
#      mon 'allow r' \
#      osd 'allow class-read object_prefix rbd_children, allow rwx pool=kubernetes'
# 5. Get the keys: 
#    ceph auth get-key client.dungeon-provisioner
#    ceph auth get-key client.dungeon
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret
    namespace: ceph-csi
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:kxOWvj2ThDKnksdhUYhaBUVErJlzPGUF+KV2df8klKlvH1gjs8HtgpAYdQ==,iv:Q7agMmrA4Gwmtn8qOFBh3asA2tV8gJq8SPNIiTafyjU=,tag:Egey4vt7pBMpLU0QGuGwvw==,type:comment]
    userID: ENC[AES256_GCM,data:Ll2hEXIo4MyjN8kzIMFf1NtYsQ==,iv:s8BBgvI4MGtGDXHA4uDecpfx7jetWTf1abQo+fMQ68E=,tag:wDn+A+ROhFYcQp/be3TWgQ==,type:str]
    userKey: ENC[AES256_GCM,data:aotbobI+1Lp9BCCBQRXMgDp5DNSWwGeOaucWy3eYKHYJ91ihm9+KqA==,iv:wDZVqwWGqnKsrwCZrJCkppcW08u6Rb/xQNJ7ENGcuxU=,tag:nSyzkeZ4RolBxariVM2Xrg==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBydkFPOVRHVnlDbjRXd2FI
            VWRIeVltQzdMRlNIRW5FcTdYbmpXMnlGSlhVCjVDcUd0bjhuWk1wU2ZxRFJERlVE
            SHQ5Q29NVEM4U2g3dWhBY0d5bkxLY3cKLS0tIGlhMGg5RFNoZW1qK2dRNnNxcndo
            R0RMc205Tll4aS9kQmZMY0hBcnJ6enMKKtwOaSTV7v3z+Pl5XHaQUZG9xPnCHYiq
            18fz3C2dGYLe8jnGjcVFXTLx1qNhyHdEOtHpLR6vEqVucvpzS7Ov0A==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-23T03:13:34Z"
    mac: ENC[AES256_GCM,data:aVUgv623d+G6Om3bRvv/BScmnl0HH6GUKOnbwOQjJQW45sLG+V3m1t2DnZdNatp1Bb3tA8V5taPR+tzIED/4Fwas8NacfSxWIDMoHPwZOXMbMGQtXkRZo5PxZQHnFIxZCOjotlTzBHj6E81erJGTqUElTicp7tGe+wqsGnhYoZ4=,iv:mm2ctUhcOspCk0+WTmyVtvkantQbG7IOS8eS8ULu5Ro=,tag:uGh8+0Tq7k/w2pzvTmEx6A==,type:str]
    pgp: []
    encrypted_regex: ^(data|stringData)$
    version: 3.8.1
---
apiVersion: v1
kind: Secret
metadata:
    name: ceph-secret-user
    namespace: ceph-csi
type: kubernetes.io/rbd
stringData:
    #ENC[AES256_GCM,data:bN9na18AtAQqbXg5Fwr0XHdLMtWPNubRhZsNS2bxbOVu2VYIeuGO,iv:BmlA0dy6uLVSZClFc5bEwthLJXXbkURUNlwB2fGYDoU=,tag:qE/19s8cBhif/J0izKkDdw==,type:comment]
    userID: ENC[AES256_GCM,data:ccIU7iClkw==,iv:7ZgCCRYP+44W7nFPoMhVgkyjO+2pberQkI8BSyFBMhk=,tag:RpBmapBxXdV3XdbO417maQ==,type:str]
    userKey: ENC[AES256_GCM,data:VvIerBp3apELKb+NwgpSJy+caxal7vqeYN1yE6JNgvVrtEKP89rJPw==,iv:7LwEl3T8IXMdSX7Z97oD/fGIrsnZNYPIIWQdyfY6rYU=,tag:/x9C0s33q2T6RHw3CBha0w==,type:str]
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1y8vegwlhcdgerrtn5947j5lcsswcu0zz6ukhs0hvvhsp79sa99nsn82dkr
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBydkFPOVRHVnlDbjRXd2FI
            VWRIeVltQzdMRlNIRW5FcTdYbmpXMnlGSlhVCjVDcUd0bjhuWk1wU2ZxRFJERlVE
            SHQ5Q29NVEM4U2g3dWhBY0d5bkxLY3cKLS0tIGlhMGg5RFNoZW1qK2dRNnNxcndo
            R0RMc205Tll4aS9kQmZMY0hBcnJ6enMKKtwOaSTV7v3z+Pl5XHaQUZG9xPnCHYiq
            18fz3C2dGYLe8jnGjcVFXTLx1qNhyHdEOtHpLR6vEqVucvpzS7Ov0A==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2025-09-23T03:13:34Z"
    mac: ENC[AES256_GCM,data:aVUgv623d+G6Om3bRvv/BScmnl0HH6GUKOnbwOQjJQW45sLG+V3m1t2DnZdNatp1Bb3tA8V5taPR+tzIED/4Fwas8NacfSxWIDMoHPwZOXMbMGQtXkRZo5PxZQHnFIxZCOjotlTzBHj6E81erJGTqUElTicp7tGe+wqsGnhYoZ4=,iv:mm2ctUhcOspCk0+WTmyVtvkantQbG7IOS8eS8ULu5Ro=,tag:uGh8+0Tq7k/w2pzvTmEx6A==,type:str]
    pgp: []
    encrypted_regex: ^(data|stringData)$
    version: 3.8.1
