apiVersion: v1
kind: ConfigMap
metadata:
  name: PLACEHOLDER_SERVICE_CONFIG
data:
  nvidia-runtime-dirs.service: |
    [Unit]
    Description=Create NVIDIA runtime directories for GPU Operator
    Before=kubelet.service
    DefaultDependencies=no

    [Service]
    Type=oneshot
    RemainAfterExit=yes
    ExecStart=/bin/mkdir -p /run/nvidia/driver/dev
    ExecStart=/bin/mkdir -p /run/nvidia/toolkit
    ExecStart=/bin/mkdir -p /run/nvidia/validations
    ExecStart=/bin/mkdir -p /var/run/cdi
    ExecStart=/bin/chmod 755 /run/nvidia
    ExecStart=/bin/chmod 755 /run/nvidia/driver
    ExecStart=/bin/chmod 755 /run/nvidia/driver/dev
    ExecStart=/bin/chmod 755 /run/nvidia/toolkit
    ExecStart=/bin/chmod 755 /run/nvidia/validations
    ExecStart=/bin/chmod 755 /var/run/cdi

    [Install]
    WantedBy=multi-user.target
