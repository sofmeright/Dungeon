apiVersion: v1
kind: ConfigMap
metadata:
  name: zitadel-config
data:
  zitadel-config.yaml: |
    Log:
      Level: info

    Port: 8080
    ExternalPort: 443
    ExternalDomain: PLACEHOLDER_DOMAIN
    ExternalSecure: true

    Database:
      Postgres:
        Host: PLACEHOLDER_POSTGRES_HOST
        Port: 5432
        Database: zitadel
        User:
          Username: zitadel
          SSL:
            Mode: disable
        Admin:
          Username: postgres
          SSL:
            Mode: disable
        MaxOpenConns: 25
        MaxIdleConns: 10
        MaxConnLifetime: 1h
        MaxConnIdleTime: 5m

    Telemetry:
      Enabled: false

    DefaultInstance:
      SMTPConfiguration:
        SMTP:
          Host: smtp.gmail.com:465
          TLS: true
        From: PLACEHOLDER_SMTP_FROM
        FromName: PLACEHOLDER_SMTP_FROM_NAME

    SystemDefaults:
      SecretGenerators:
        PasswordSaltCost: 14
      Domain: PLACEHOLDER_DOMAIN
      ZitadelDocs:
        Enabled: true
        ExternalDomain: docs.zitadel.com

    # Kubernetes Integration
    Machine:
      Identification:
        Hostname:
          Enabled: true
        Webhook:
          Enabled: false

    # Enable Actions for K8s webhook integration
    Actions:
      HTTP:
        DenyList: []  # Allow all for internal K8s calls