apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: ceph-csi-rbd
  namespace: flux-system
spec:
  values:
    provisioner:
      enableHostNetwork: true
      httpMetrics:
        enabled: true
        containerPort: 8081
    csiConfig:
      - clusterID: "0985467c-d8f3-4483-b27f-f0a512397ec2"
        monitors:
          - "[fc00:f1:ada:104e:1ace::1]:6789"
          - "[fc00:f1:ada:104e:1ace::2]:6789"
          - "[fc00:f1:ada:104e:1ace::3]:6789"
          - "[fc00:f1:ada:104e:1ace::4]:6789"
          - "[fc00:f1:ada:104e:1ace::5]:6789"
    # Removed cephconf field - cluster config provided via csiConfig above
    # ceph-config volume changed from ConfigMap to emptyDir via daemonset-patch.yaml
    # ConfigMaps are read-only and cause driver to fail writing /etc/ceph/keyring