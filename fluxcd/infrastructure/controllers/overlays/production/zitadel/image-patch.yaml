---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: zitadel
spec:
  template:
    spec:
      containers:
      - name: zitadel
        image: ghcr.io/zitadel/zitadel:v4.6.1
---
# Init and setup job patches removed - jobs disabled in base
---
apiVersion: batch/v1
kind: Job
metadata:
  name: zitadel-admin-sa-init
spec:
  template:
    spec:
      containers:
      - name: extract-admin-sa
        image: docker.io/alpine:3.21
---
apiVersion: batch/v1
kind: Job
metadata:
  name: zitadel-admin-sa-to-vault
spec:
  template:
    spec:
      initContainers:
      - name: wait-for-secret
        image: registry.k8s.io/kubectl:v1.34.0
      containers:
      - name: sync-to-vault
        image: docker.jcr.pcfae.com/curlimages/curl:8.16.0
---
apiVersion: batch/v1
kind: Job
metadata:
  name: zitadel-login-v2-provision
spec:
  template:
    spec:
      initContainers:
      - name: wait-for-zitadel
        image: docker.jcr.pcfae.com/curlimages/curl:8.16.0
      containers:
      - name: provision-login-client
        image: docker.jcr.pcfae.com/curlimages/curl:8.16.0