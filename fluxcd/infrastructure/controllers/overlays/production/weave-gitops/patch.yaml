apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: weave-gitops
spec:
  targetNamespace: gossip-stone
  valuesFrom:
    - kind: ConfigMap
      name: weave-gitops-values
      valuesKey: values.yaml
  values:
    service:
      annotations:
        lbipam.cilium.io/ips: "172.22.30.137"
        lbipam.cilium.io/sharing-key: "gossip-stone"
        lbipam.cilium.io/sharing-cross-namespace: "*"
    resources:
      requests:
        cpu: 100m
        memory: 64Mi
      limits:
        cpu: 1
        memory: 512Mi
    securityContext:
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: true
      runAsNonRoot: true
      runAsUser: 1000