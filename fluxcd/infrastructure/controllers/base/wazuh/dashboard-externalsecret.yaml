apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: wazuh-dashboard-secrets
spec:
  secretStoreRef:
    kind: ClusterSecretStore
    name: PLACEHOLDER_SECRET_STORE
  target:
    name: wazuh-dashboard-secrets
    template:
      engineVersion: v2
      data:
        wazuh.yml: |
          hosts:
            - PLACEHOLDER_API_ID:
                url: "https://wazuh-manager"
                port: 55000
                username: {{ .API_USERNAME }}
                password: "{{ .API_PASSWORD }}"
                run_as: false
  dataFrom:
    - extract:
        key: PLACEHOLDER_VAULT_PATH
      rewrite:
        - regexp:
            source: "^dashboard-(.*)$"
            target: "$1"
