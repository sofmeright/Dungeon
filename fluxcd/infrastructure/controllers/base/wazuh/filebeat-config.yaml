apiVersion: v1
data:
  filebeat.yml: |-
    output.elasticsearch:
      hosts: ["https://wazuh-indexer:9200"]
      username: ${INDEXER_USERNAME}
      password: ${INDEXER_PASSWORD}
      ssl.certificate_authorities:
        - /etc/ssl/root-ca.pem
      ssl.certificate: /etc/ssl/filebeat.pem
      ssl.key: /etc/ssl/filebeat.key

    filebeat.modules:
      - module: wazuh
        alerts:
          enabled: true
        archives:
          enabled: false

    setup.template.json.enabled: true
    setup.template.json.path: '/etc/filebeat/wazuh-template.json'
    setup.template.json.name: 'wazuh'
    setup.template.overwrite: true
    setup.ilm.enabled: false

    logging.level: info
    logging.to_files: true
    logging.files:
      path: /var/log/filebeat
      name: filebeat
      keepfiles: 7
      permissions: 0644
kind: ConfigMap
metadata:
  name: wazuh-filebeat-config
