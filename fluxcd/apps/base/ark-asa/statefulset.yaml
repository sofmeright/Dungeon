apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: ark-sa-tmc
spec:
  serviceName: ark-sa-tmc
  replicas: 1
  selector:
    matchLabels:
      app: ark-sa-tmc
  template:
    metadata:
      labels:
        app: ark-sa-tmc
    spec:
      enableServiceLinks: false
      securityContext:
        fsGroup: 1001
      initContainers:
      - name: fix-permissions
        image: docker.io/library/busybox:latest
        command:
        - sh
        - -c
        - chown -R 1001:1001 /home/pok/arkserver && chmod -R 755 /home/pok/arkserver
        volumeMounts:
        - name: shooting-gallery-ark-sa-tmc-serverfiles
          mountPath: /home/pok/arkserver
      containers: []
      # Containers will be added via overlay patches for each map
  volumeClaimTemplates:
  - metadata:
      name: shooting-gallery-ark-sa-tmc-serverfiles
    spec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 250Gi
  - metadata:
      name: shooting-gallery-ark-sa-tmc-cluster
    spec:
      accessModes:
      - ReadWriteOnce
      resources:
        requests:
          storage: 20Gi
