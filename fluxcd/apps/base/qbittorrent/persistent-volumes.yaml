# Static PersistentVolumes for swift-sail named RBDs
# These reference exact RBD image names in Ceph
# CSI automatically creates RBDs if volumeHandle doesn't exist (idempotent)
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: swift-sail-qbittorrent-gluetun-config-0
spec:
  capacity:
    storage: 64Mi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain  # CRITICAL: Protects RBD from deletion
  storageClassName: ceph-rbd-static
  csi:
    driver: rbd.csi.ceph.com
    fsType: ext4
    volumeHandle: swift-sail-qbittorrent-gluetun-config-0  # Unique ID
    volumeAttributes:
      clusterID: "0985467c-d8f3-4483-b27f-f0a512397ec2"  # Your Ceph FSID
      pool: dungeon
      staticVolume: "true"
      imageName: swift-sail-qbittorrent-gluetun-config-0  # RBD image name in Ceph
      imageFeatures: layering
    nodeStageSecretRef:
      name: ceph-secret-user
      namespace: kube-system
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: swift-sail-qbittorrent-config-0
spec:
  capacity:
    storage: 64Mi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  storageClassName: ceph-rbd-static
  csi:
    driver: rbd.csi.ceph.com
    fsType: ext4
    volumeHandle: swift-sail-qbittorrent-config-0
    volumeAttributes:
      clusterID: "0985467c-d8f3-4483-b27f-f0a512397ec2"
      pool: dungeon
      staticVolume: "true"
      imageName: swift-sail-qbittorrent-config-0
      imageFeatures: layering
    nodeStageSecretRef:
      name: ceph-secret-user
      namespace: kube-system
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: swift-sail-qbittorrent-downloads-0
spec:
  capacity:
    storage: 336Gi
  accessModes:
    - ReadWriteOnce
  persistentVolumeReclaimPolicy: Retain
  storageClassName: ceph-rbd-static
  csi:
    driver: rbd.csi.ceph.com
    fsType: ext4
    volumeHandle: swift-sail-qbittorrent-downloads-0
    volumeAttributes:
      clusterID: "0985467c-d8f3-4483-b27f-f0a512397ec2"
      pool: dungeon_hdd
      staticVolume: "true"
      imageName: swift-sail-qbittorrent-downloads-0
      imageFeatures: layering
    nodeStageSecretRef:
      name: ceph-secret-user
      namespace: kube-system
