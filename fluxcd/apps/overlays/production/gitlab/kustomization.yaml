apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: hyrule-castle
resources:
  - ../../../base/gitlab
  - externalsecret-root.yaml
  - externalsecret-redis.yaml
  - externalsecret-s3.yaml
  - externalsecret-s3-creds.yaml
  - httproute.yaml
patches:
  - path: helmrelease-patch.yaml
    target:
      kind: HelmRelease
      name: gitlab
  - path: cluster-patch.yaml
    target:
      kind: Cluster
      name: gitlab-postgresql
  - path: externalsecret-credentials-patch.yaml
    target:
      kind: ExternalSecret
      name: gitlab-postgresql-credentials
  - path: externalsecret-praefect-patch.yaml
    target:
      kind: ExternalSecret
      name: gitlab-praefect-credentials
  - path: redis-cluster-patch.yaml
    target:
      kind: RedisCluster
      name: gitlab-redis
  - path: configmap-praefect-init-sql-patch.yaml
    target:
      kind: ConfigMap
      name: praefect-init-sql
  - path: job-praefect-db-init-patch.yaml
    target:
      kind: Job
      name: gitlab-praefect-db-init
