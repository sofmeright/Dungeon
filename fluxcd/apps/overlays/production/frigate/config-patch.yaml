apiVersion: v1
kind: ConfigMap
metadata:
  name: frigate-config
data:
  config.yaml: |
    # Frigate Production Configuration
    # UI-managed settings (zones, masks, filters) stored in frigate.db

    version: 0.14-0

    mqtt:
      enabled: false

    # ONNX detector with TensorRT auto-detection (via -tensorrt image)
    detectors:
      onnx:
        type: onnx

    # YOLOx model - downloaded by init container
    model:
      model_type: yolox
      width: 640
      height: 640
      input_tensor: nchw
      input_pixel_format: rgb
      input_dtype: float
      path: /config/model_cache/yolox_s.onnx
      labelmap_path: /labelmap.txt

    # Default ffmpeg settings
    ffmpeg:
      hwaccel_args: preset-nvidia-h264

    # Global detect defaults
    detect:
      enabled: true
      width: 1280
      height: 720
      fps: 5

    # Global record defaults
    record:
      enabled: true
      retain:
        days: 7
        mode: motion
      alerts:
        retain:
          days: 14
          mode: motion
      detections:
        retain:
          days: 14
          mode: motion

    # Global snapshots defaults
    snapshots:
      enabled: true
      retain:
        default: 14

    # Production cameras
    cameras:
      sideporch:
        enabled: true
        ffmpeg:
          inputs:
            - path: rtsp://frigate:{FRIGATE_RTSP_PASSWORD}@10.9.11.129:554/h264Preview_01_sub
              roles:
                - detect
            - path: rtsp://frigate:{FRIGATE_RTSP_PASSWORD}@10.9.11.129:554/h265Preview_01_main
              roles:
                - record
        detect:
          enabled: true
          width: 640
          height: 480
          fps: 5
        zones:
          driveway:
            coordinates: 0.777,0.177,0.959,0.278,0.918,0.572,0.562,0.821,0.322,0.438,0.308,0.181,0.665,0.118
          side_yard:
            coordinates: 1,0.27,0.998,0.998,0.149,1,0.119,0.841,0.099,0.232,0.311,0.181,0.565,0.354
          sidewalk:
            coordinates: 0.104,0.279,0.162,0.116,0.614,0.046,0.758,0.143
            loitering_time: 30
          driveway_fence:
            coordinates: 0.818,0.2,0.665,0.118,0.606,0.047,0.8,0.145
            loitering_time: 30
        review:
          alerts:
            required_zones:
              - side_yard
              - driveway
              - sidewalk
              - driveway_fence
          detections:
            required_zones:
              - side_yard
              - driveway
              - sidewalk
              - driveway_fence
        record:
          enabled: true
          retain:
            days: 45
            mode: motion
