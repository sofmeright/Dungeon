# Gitleaks configuration for secret scanning
# https://github.com/gitleaks/gitleaks

title = "Gitleaks Config for Dungeon K8s Cluster"

# Extend default gitleaks config
[extend]
useDefault = true

# Allowlist for false positives
[allowlist]
description = "Allowlisted files and patterns"

# Ignore specific paths that are known safe
paths = [
  '''\.md$''',
  '''docs/''',
  '''\.sops\.yaml$''',  # SOPS encrypted files
  '''\.enc\.yaml$''',   # SOPS encrypted files
]

# Ignore example/placeholder values and known safe patterns
[[allowlist.regexes]]
regex = '''PLACEHOLDER_'''
description = "Template placeholder values"

[[allowlist.regexes]]
regex = '''example\.com'''
description = "Example domains"

[[allowlist.regexes]]
regex = '''changeme'''
description = "Placeholder passwords"

[[allowlist.regexes]]
regex = '''your-.*-here'''
description = "Placeholder strings"

[[allowlist.regexes]]
regex = '''0985467c-d8f3-4483-b27f-f0a512397ec2'''
description = "Ceph cluster FSID (public identifier, not a secret)"

[[allowlist.regexes]]
regex = '''a3ViZXJuZXRlcw=='''
description = "Example Kubernetes token"

[[allowlist.regexes]]
regex = '''age1[a-z0-9]{58}'''
description = "SOPS age public keys (safe to commit)"
