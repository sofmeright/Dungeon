server {
	listen 80;
	listen [::]:80;

	# SSL configuration
	listen 443 ssl;
	listen [::]:443 ssl;
    server_name pcfae.com; 

	access_log                /var/log/nginx/_default.pcfae.com.access.log;
	error_log                 /var/log/nginx/_default.pcfae.com.error.log;

	# TLS configuration
	# sudo openssl req -x509 -newkey rsa:4096 -keyout /etc/letsencrypt/live/172.122.122.104/privkey.pem -out /etc/letsencrypt/live/172.122.122.104/fullchain.pem -sha256 -days 3650 -nodes \
	# -subj "/C=XX/ST=Washington/L=Tacoma/O=PrecisionPlanIT/OU=Internal/CN=cell-membrane"
    ssl_certificate /etc/letsencrypt/live/pcfae.com/fullchain.pem; # managed by Certbot
    ssl_certificate_key /etc/letsencrypt/live/pcfae.com/privkey.pem; # managed by Certbot
	ssl_protocols             TLSv1.2 TLSv1.3;

	ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA384';
	ssl_prefer_server_ciphers on;
	ssl_session_cache         shared:SSL:50m;
	ssl_session_timeout       1d;

	# OCSP Stapling ---
	# fetch OCSP records from URL in ssl_certificate and cache them
	ssl_stapling on;
	ssl_stapling_verify on;
	ssl_dhparam /etc/nginx/dhparam.pem;

    #...default server configuration   
    location / {
        return 404;
    }
    location /_error_pages {
        alias /mnt/app_data/Server/HTML/404/;
        try_files $uri $uri/ =404;
    } 
    error_page 400 /403.html;
    error_page 401 /401.html;
    error_page 402 /402.html;
    error_page 403 /403.html;
    error_page 404 /404.html;
    error_page 405 /405.html;
    error_page 406 /406.html;
    error_page 502 /502.html;
    location = /400.html { root  /mnt/app_data/Server/HTML/404/back2thefuture; }
    location = /401.html { root  /mnt/app_data/Server/HTML/404/back2thefuture; }
    location = /402.html { root  /mnt/app_data/Server/HTML/404/back2thefuture; }
    location = /403.html { root  /mnt/app_data/Server/HTML/404/back2thefuture; }
    location = /404.html { root  /mnt/app_data/Server/HTML/404/back2thefuture; }
    location = /405.html { root  /mnt/app_data/Server/HTML/404/back2thefuture; }
    location = /406.html { root  /mnt/app_data/Server/HTML/404/back2thefuture; }
    location = /502.html { root  /mnt/app_data/Server/HTML/502/back2thefuture; }
}