server {
    listen                  80;
    listen                  [::]:80;
    listen                  443                                             ssl http2;
    listen                  [::]:443                                        ssl http2;

    server_name             gitlab.prplanit.com;

    ssl_certificate         /etc/letsencrypt/live/prplanit.com/fullchain.pem;
    ssl_certificate_key     /etc/letsencrypt/live/prplanit.com/privkey.pem;

    access_log              /var/log/nginx/gitlab.prplanit.com-access.log;
    error_log               /var/log/nginx/gitlab.prplanit.com-error.log;

    add_header              'Access-Control-Allow-Origin'                   'https://apps.prplanit.com https://apps.pcfae.com/';
    more_set_headers        X-Frame-Options "ALLOW-FROM                     https://apps.prplanit.com https://apps.pcfae.com/";
    more_set_headers        "Content-Security-Policy: frame-ancestors       'self' https://apps.prplanit.com/ https://apps.pcfae.com/;"; 

    location / {
        add_header          X-Served-By         $host;
        proxy_set_header    Host                $host;
        proxy_set_header    X-Forwarded-Scheme  $scheme;
        proxy_set_header    X-Forwarded-Proto   $scheme;
        proxy_set_header    X-Forwarded-For     $remote_addr;
        proxy_set_header    X-Real-IP           $remote_addr;

        proxy_pass          http://10.30.1.123:8017$request_uri;

    }

}