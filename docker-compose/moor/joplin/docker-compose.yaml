services:
    db:
        image: postgres:15
        volumes:
            - /mnt/app_data/Server/_docker_stack/joplin-server/postgresql/data:/var/lib/postgresql/data
        ports:
            - "5432:5432"
        restart: unless-stopped
        env_file: stack.env
        #labels: &logging
          #labels-regex: "^.+"
          #log_driver: "loki"
          #log_opt:
            #loki-batch-size:"400"
            #loki-url:"http://localhost:3100/loki/api/v1/push"
            #max-size:"10m"
            #max-file:"3"
        
    app:
        #labels: *logging
        image: joplin/server:latest
        depends_on:
            - db
        ports:
            - "22300:22300"
        restart: unless-stopped
        env_file: stack.env
